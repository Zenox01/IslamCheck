!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("@cassette/core"),require("resize-observer-polyfill")):"function"==typeof define&&define.amd?define(["react","@cassette/core","resize-observer-polyfill"],t):"object"==typeof exports?exports.cassetteComponents=t(require("react"),require("@cassette/core"),require("resize-observer-polyfill")):e.cassetteComponents=t(e.React,e.cassetteCore,e.ResizeObserver)}("undefined"!=typeof self?self:this,function(e,t,n){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist",n(n.s=3)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),i=n(2),s=n.n(i);let a,l;"undefined"!=typeof document&&(void 0!==document.hidden?(a="hidden",l="visibilitychange"):void 0!==document.msHidden?(a="msHidden",l="msvisibilitychange"):void 0!==document.webkitHidden&&(a="webkitHidden",l="webkitvisibilitychange"));var c=function(e){if(a&&document[a]){let t,n=!1;return document.addEventListener(l,()=>{n||(t=requestAnimationFrame(e))},{once:!0}),()=>{n=!0,cancelAnimationFrame(t)}}{const t=requestAnimationFrame(e);return()=>cancelAnimationFrame(t)}};function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const h="undefined"!=typeof performance&&performance.now?()=>performance.now():()=>Date.now();function p(e){return`${e}px`}class m extends r.PureComponent{constructor(e){super(e),this.state={contentHeight:0},this.moveMarquee=this.moveMarquee.bind(this),this.handleResize=this.handleResize.bind(this)}componentDidMount(){this.requestMoveMarqueeAnimationFrame(),this.marqueeContainerElementWidth=getComputedStyle(this.marqueeContainerElement).width;const e=getComputedStyle(this.movingContentContainerElement);this.movingContentContainerElementWidth=e.width,this.setState({contentHeight:e.height}),this.resizeObserver=new s.a(this.handleResize),this.resizeObserver.observe(this.marqueeContainerElement),this.resizeObserver.observe(this.movingContentContainerElement),this.lastMovementTime=h()}componentWillUnmount(){this.cancelRaf(),this.resizeObserver.disconnect()}requestMoveMarqueeAnimationFrame(){this.cancelRaf=c(this.moveMarquee)}moveMarquee(){const e=this.props,t=e.pixelsPerSecond,n=e.scrollDirection,r=h(),o=r-this.lastMovementTime;if(this.lastMovementTime=r,"left"===n?this.movingContentContainerElement.style.right=void 0:this.movingContentContainerElement.style.left=void 0,this.marqueeContainerElementWidth>=this.movingContentContainerElementWidth)this.movingContentContainerElement.style[n]=0;else{const e=t*o/1e3,r=function(e){return Number(e.slice(0,-2))}(this.movingContentContainerElement.style[n])-e;r>0-this.movingContentContainerElementWidth?this.movingContentContainerElement.style[n]=p(r):this.movingContentContainerElement.style[n]=p(this.marqueeContainerElementWidth)}this.requestMoveMarqueeAnimationFrame()}handleResize(e){for(const t of e)t.target===this.marqueeContainerElement&&(this.marqueeContainerElementWidth=t.contentRect.width),t.target===this.movingContentContainerElement&&(this.movingContentContainerElementWidth=t.contentRect.width,this.setState({contentHeight:t.contentRect.height}))}render(){const e=this.props,t=e.content,n=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,["content"]);return delete n.pixelsPerSecond,delete n.scrollDirection,o.a.createElement("div",d({},n,{ref:e=>this.marqueeContainerElement=e,style:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){u(e,t,n[t])})}return e}({position:"relative",overflow:"hidden",height:this.state.contentHeight},n.style||{})}),o.a.createElement("div",{ref:e=>this.movingContentContainerElement=e,style:{position:"absolute",whiteSpace:"nowrap"}},t))}}m.defaultProps={pixelsPerSecond:30,scrollDirection:"left"};var f=m,g=n(1);var v=function(e,t){const n=`${100*(1-(e||0))}%`,r={position:"absolute",left:0,right:0,top:0,bottom:0};switch(t){case"left":r.left=n,r.willChange="left";break;case"right":r.right=n,r.willChange="right";break;case"up":r.top=n,r.willChange="top";break;case"down":r.bottom=n,r.willChange="bottom"}return r};var y=function(e,t){const n=`${100*(e||0)}%`,r={position:"absolute",transform:"translate(-50%, -50%)"};switch(t){case"left":r.top="50%",r.right=n,r.willChange="right",r.transform="translate(50%, -50%)";break;case"right":r.top="50%",r.left=n,r.willChange="left",r.transform="translate(-50%, -50%)";break;case"up":r.left="50%",r.bottom=n,r.willChange="bottom",r.transform="translate(-50%, 50%)";break;case"down":r.left="50%",r.top=n,r.willChange="top",r.transform="translate(-50%, -50%)"}return r};function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class w extends r.PureComponent{render(){const e=this.props,t=e.progressClassName,n=e.progressStyle,r=e.progress,i=e.progressDirection,s=e.handle,a=e.progressBarRef,l=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,["progressClassName","progressStyle","progress","progressDirection","handle","progressBarRef"]);return o.a.createElement("div",b({},l,{ref:a}),o.a.createElement("div",{style:{position:"relative",width:"100%",height:"100%",touchAction:"none"}},o.a.createElement("div",{className:t,style:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){C(e,t,n[t])})}return e}({},n||{},v(r,i))}),s&&o.a.createElement("div",{style:y(r,i)},s)))}}var O=Object(r.forwardRef)((e,t)=>o.a.createElement(w,b({},e,{progressBarRef:t})));const P=20,j=["top","right","bottom","left","width","height","size","weight"],E="undefined"!=typeof MutationObserver,S=new Set,x=new Map,k=new Map;let A,M,R,D,T=!1;function H(){clearTimeout(D);const e=[];for(const t of S){const n=q(t);V(x.get(t),n)&&(x.set(t,n),e.push(t))}for(const t of e)k.get(t)(x.get(t));e.length&&(D=setTimeout(H,P))}function L(){A=document.body.scrollTop,M=document.body.scrollLeft}function W(e){let t=e.propertyName,n=void 0===t?"":t;j.some(e=>-1!==n.indexOf(e))&&H()}function q(e){const t=e.getBoundingClientRect();return{pageTop:t.top+A,pageLeft:t.left+M,width:t.width,height:t.height}}function V(e,t){return e.pageTop!==t.pageTop||e.pageLeft!==t.pageLeft||e.width!==t.width||e.height!==t.height}var z=function(e,t){return S.size||T||(document.addEventListener("transitionend",W),window.addEventListener("resize",H),E?(R=new MutationObserver(H)).observe(document,{attributes:!0,subtree:!0}):document.addEventListener("DOMSubtreeModified",H),document.addEventListener("scroll",L),L(),T=!0),S.add(e),x.set(e,q(e)),k.set(e,t),t(x.get(e)),()=>{S.delete(e),x.delete(e),k.delete(e),S.size||T&&(document.removeEventListener("transitionend",W),window.removeEventListener("resize",H),E?R.disconnect():document.removeEventListener("DOMSubtreeModified",H),document.removeEventListener("scroll",L),T=!1)}};function F(){return(F=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}const N="\ncursor: default;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  -webkit-touch-callout: none;\n",I=37,B=39,$=38,U=40;class _ extends r.PureComponent{constructor(e){super(e),this.state={adjusting:!1,tempProgress:null},this.progressContainer=null,this.setProgressContainerRef=this.setProgressContainerRef.bind(this),this.handleAdjustProgress=this.handleAdjustProgress.bind(this),this.handleAdjustComplete=this.handleAdjustComplete.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this)}componentDidMount(){window.addEventListener("mousemove",this.handleAdjustProgress),document.addEventListener("touchmove",this.handleAdjustProgress),window.addEventListener("mouseup",this.handleAdjustComplete),document.addEventListener("touchend",this.handleAdjustComplete),this.unobserve=z(this.progressContainer,e=>{this.cachedContainerRect=e}),setTimeout(()=>{const e=document.createElement("style"),t=`noselect_${Math.random().toString(16).slice(2,7)}`;e.innerText=`.${t}{${N}}`,document.body.appendChild(e),this.noselectStyleElement=e,this.noselectClassName=t})}componentDidUpdate(e,t){const n=this.state,r=n.adjusting,o=n.tempProgress;r&&o!==t.tempProgress&&this.props.onAdjustProgress(o)}componentWillUnmount(){window.removeEventListener("mousemove",this.handleAdjustProgress),document.removeEventListener("touchmove",this.handleAdjustProgress),window.removeEventListener("mouseup",this.handleAdjustComplete),document.removeEventListener("touchend",this.handleAdjustComplete),this.unobserve(),this.toggleNoselect(!1),this.noselectStyleElement&&this.noselectStyleElement.parentNode.removeChild(this.noselectStyleElement)}setProgressContainerRef(e){this.progressContainer=e}toggleNoselect(e){document.body.classList[e?"add":"remove"](this.noselectClassName)}getProgressFromPageCoordinates(e,t){const n=this.cachedContainerRect,r=n.pageLeft,o=n.pageTop,i=n.width,s=n.height;switch(this.props.progressDirection){case"down":return(t-o)/s;case"left":return 1-(e-r)/i;case"up":return 1-(t-o)/s;case"right":default:return(e-r)/i}}handleAdjustProgress(e){if(this.props.readonly)return;if("mousedown"===e.type||"touchstart"===e.type)this.toggleNoselect(!0);else if(!this.state.adjusting)return;e.preventDefault();const t="touch"===e.type.slice(0,5),n=t?e.targetTouches.item(0).pageX:e.pageX,r=t?e.targetTouches.item(0).pageY:e.pageY,o=this.getProgressFromPageCoordinates(n,r),i=Object(g.convertToNumberWithinIntervalBounds)(o,0,1);this.setState({adjusting:!0,tempProgress:i})}handleAdjustComplete(e){const t=this.props.onAdjustComplete;this.toggleNoselect(!1);const n=this.state,r=n.adjusting,o=n.tempProgress;r&&(e.preventDefault(),this.setState({adjusting:!1,tempProgress:null}),t(o))}handleKeyDown(e){if(this.props.readonly)return;let t=this.props.progress;switch(e.keyCode){case I:case U:t-=.01;break;case $:case B:t+=.01;break;default:return}e.preventDefault(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),this.setState({adjusting:!0,tempProgress:Object(g.convertToNumberWithinIntervalBounds)(t,0,1)})}render(){const e=this.props,t=e.progressClassName,n=e.progressStyle,r=e.progress,i=e.progressDirection,s=e.handle,a=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,["progressClassName","progressStyle","progress","progressDirection","handle"]),l=this.state,c=l.adjusting,d=l.tempProgress;return delete a.readonly,delete a.onAdjustProgress,delete a.onAdjustComplete,o.a.createElement(O,F({tabIndex:0},a,{role:"slider",ref:this.setProgressContainerRef,progressClassName:t,progressStyle:n,progress:c?d:r,progressDirection:i,handle:s,onMouseDown:this.handleAdjustProgress,onTouchStart:this.handleAdjustProgress,onKeyDown:this.handleKeyDown,onKeyUp:this.handleAdjustComplete,onBlur:this.handleAdjustComplete}))}}_.defaultProps={readonly:!1};var K=_;function X(){return(X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var Y=Object(g.playerContextFilter)(class extends r.PureComponent{constructor(e){super(e),this.handleSeekPreview=this.handleSeekPreview.bind(this),this.handleSeekComplete=this.handleSeekComplete.bind(this)}handleSeekPreview(e){this.props.onSeekPreview(e*this.props.duration)}handleSeekComplete(e){this.props.onSeekComplete(e*this.props.duration)}render(){const e=this.props,t=e.playlist,n=e.currentTime,r=e.seekPreviewTime,i=e.seekInProgress,s=e.duration,a=e.durationOverride,l=void 0===a?s:a,c=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,["playlist","currentTime","seekPreviewTime","seekInProgress","duration","durationOverride"]);delete c.onSeekPreview,delete c.onSeekComplete;const d=l?(i?r:n)/l:0;return o.a.createElement(K,X({},c,{progress:d,readonly:!Object(g.isPlaylistValid)(t),onAdjustProgress:this.handleSeekPreview,onAdjustComplete:this.handleSeekComplete}))}},["playlist","currentTime","seekPreviewTime","seekInProgress","duration","onSeekPreview","onSeekComplete"]);function G(){return(G=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var J=Object(g.playerContextFilter)(class extends r.PureComponent{render(){const e=this.props,t=e.currentTime,n=e.duration,r=e.durationOverride,i=void 0===r?n:r,s=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,["currentTime","duration","durationOverride"]),a=i?t/i:0;return o.a.createElement(O,G({},s,{progress:a}))}},["currentTime","duration"]);function Q(){return(Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ee="#000";class te extends r.Component{componentDidMount(){this.div.appendChild(this.props.canvas)}render(){return o.a.createElement("div",{style:{width:this.props.containerWidth},ref:e=>this.div=e})}}class ne extends r.PureComponent{constructor(e){super(e),this.containerWidth=0,this.containerHeight=0,this.hostedVideo=null,this.videoFrameAtTimeLastVacated=null}componentDidMount(){this.containerResizeObserver=new s.a(this.handleContainerResize.bind(this)),this.containerResizeObserver.observe(this.containerElement),this.props.registerVideoHostElement(this.containerElement,{onHostOccupied:e=>{e.style.width=`${this.containerWidth}px`,e.style.maxHeight=`${this.containerHeight}px`,this.hostedVideo=e,this.forceUpdate()},onHostVacated:e=>{const t=document.createElement("canvas");t.width=e.videoWidth,t.height=e.videoHeight,t.getContext("2d").drawImage(e,0,0,t.width,t.height),t.style.maxWidth="100%",t.style.verticalAlign="middle",this.videoFrameAtTimeLastVacated=t,this.hostedVideo=null,this.forceUpdate()}}),this.props.renderVideoIntoHostElement(this.containerElement)}componentWillUnmount(){this.containerResizeObserver.disconnect(),this.props.unregisterVideoHostElement(this.containerElement)}handleContainerResize(){const e=this.containerElement,t=e.offsetWidth,n=e.offsetHeight;t===this.containerWidth&&n===this.containerHeight||(this.hostedVideo&&(this.hostedVideo.style.width=`${t}px`,this.hostedVideo.style.maxHeight=`${n}px`),this.containerWidth=t,this.containerHeight=n,this.forceUpdate())}render(){const e=this.props,t=e.aspectRatio,n=e.fullscreen,r=e.maintainAspectRatioInFullscreen,i=e.renderPlaceholderContent,s=e.renderVideoIntoHostElement,a=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,["aspectRatio","fullscreen","maintainAspectRatioInFullscreen","renderPlaceholderContent","renderVideoIntoHostElement"]);delete a.registerVideoHostElement,delete a.unregisterVideoHostElement;const l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Z(e,t,n[t])})}return e}({display:"flex",justifyContent:"center",alignItems:"center",background:ee},a.style||{});return t&&this.containerWidth&&(!n||r)&&(l.height&&!this.warnedAboutStyleOverride&&(Object(g.logWarning)("VideoDisplay cannot use style.height prop because it is overridden by aspectRatio."),this.warnedAboutStyleOverride=!0),l.height=this.containerWidth/function(e){const t=e.split(":").map(Number);return t[0]/t[1]}(t)),o.a.createElement("div",Q({},a,{style:l,ref:e=>this.containerElement=e}),this.hostedVideo?null:i({containerWidth:this.containerWidth,containerHeight:this.containerHeight,stealVideo:()=>s(this.containerElement),renderLastShownFrame:()=>this.videoFrameAtTimeLastVacated&&o.a.createElement(te,{canvas:this.videoFrameAtTimeLastVacated,containerWidth:this.containerWidth})}))}}ne.defaultProps={aspectRatio:"16:9",maintainAspectRatioInFullscreen:!1,renderPlaceholderContent(e){const t=e.containerWidth,n=e.containerHeight,r=e.renderLastShownFrame;return o.a.createElement("div",{style:{width:t,height:n,display:"flex",justifyContent:"center",alignItems:"center"}},r())}};var re=Object(g.playerContextFilter)(ne,["registerVideoHostElement","renderVideoIntoHostElement","unregisterVideoHostElement","fullscreen"]);n.d(t,"MaybeMarquee",function(){return f}),n.d(t,"ProgressBar",function(){return K}),n.d(t,"ProgressBarDisplay",function(){return O}),n.d(t,"MediaProgressBar",function(){return Y}),n.d(t,"MediaProgressBarDisplay",function(){return J}),n.d(t,"VideoDisplay",function(){return re})}])});
//# sourceMappingURL=cassette-components.min.js.map